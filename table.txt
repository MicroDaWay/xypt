CREATE DATABASE IF NOT EXISTS xypt
DEFAULT CHARSET utf8mb4
COLLATE utf8mb4_0900_ai_ci;

CREATE TABLE `user` (
  `id` int NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `username` varchar(20) NOT NULL COMMENT '用户名',
  `password` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '密码',
  `nickname` varchar(20) DEFAULT NULL COMMENT '昵称',
  `avatar` varchar(255) DEFAULT 'https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9dpng.png' COMMENT '头像',
  `account_money` decimal(10,2) DEFAULT '0.00' COMMENT '账户金额',
  `role` int NOT NULL DEFAULT '1' COMMENT '角色 0 管理员 1 普通用户 2 骑手',
  `gender` int DEFAULT NULL COMMENT '性别 0 女 1 男',
  `phone` varchar(11) DEFAULT NULL COMMENT '手机号',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '修改时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


CREATE TABLE `rider` (
  `id` int NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `name` varchar(30) NOT NULL COMMENT '姓名',
  `phone` varchar(11) NOT NULL COMMENT '手机号',
  `id_card` varchar(18) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '身份证号',
  `address` varchar(255) NOT NULL COMMENT '常住地址',
  `user_id` int DEFAULT NULL COMMENT '用户ID',
  `examine_state` int DEFAULT NULL COMMENT '审核状态 0 待审核 1 审核通过 2 审核失败',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_time` datetime DEFAULT NULL COMMENT '修改时间',
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `rider_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


CREATE TABLE `order` (
  `id` int NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `trade_name` varchar(50) DEFAULT NULL COMMENT '物品名称',
  `desc` varchar(50) DEFAULT NULL COMMENT '描述信息',
  `fee` int DEFAULT NULL COMMENT '小费',
  `order_type` int DEFAULT NULL COMMENT '订单类型 0 代拿快递 1 代取餐品 2 代买零食',
  `order_state` int DEFAULT NULL COMMENT '订单状态 0 全部订单 1 待接单 2 待送达 3 待收货 4 待评价 5 已取消 6 已完成',
  `note` varchar(50) DEFAULT NULL COMMENT '备注',
  `evaluate` varchar(255) DEFAULT NULL COMMENT '评价',
  `rate` int DEFAULT NULL COMMENT '1-5分',
  `pay_user_id` int DEFAULT NULL COMMENT '下单人ID',
  `pay_user_phone` varchar(11) DEFAULT NULL COMMENT '下单人电话',
  `pay_user_address` varchar(255) DEFAULT NULL COMMENT '下单人地址',
  `pay_user_name` varchar(30) DEFAULT NULL COMMENT '下单人姓名',
  `receive_user_id` int DEFAULT NULL COMMENT '接单人ID',
  `receive_user_phone` varchar(11) DEFAULT NULL COMMENT '接单人电话',
  `receive_user_name` varchar(255) DEFAULT NULL COMMENT '接单人姓名',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_time` datetime DEFAULT NULL COMMENT '修改时间',
  PRIMARY KEY (`id`),
  KEY `order_type` (`order_type`),
  KEY `user_id` (`pay_user_id`),
  KEY `receive_user_id` (`receive_user_id`),
  CONSTRAINT `order_ibfk_2` FOREIGN KEY (`pay_user_id`) REFERENCES `user` (`id`),
  CONSTRAINT `order_ibfk_3` FOREIGN KEY (`receive_user_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


CREATE TABLE `address` (
  `id` int NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `building_number` varchar(10) NOT NULL COMMENT '楼号',
  `house_number` int NOT NULL COMMENT '门牌号',
  `name` varchar(20) NOT NULL COMMENT '联系人姓名',
  `phone` varchar(11) NOT NULL COMMENT '联系人电话',
  `user_id` int NOT NULL COMMENT '用户ID',
  `is_default` int NOT NULL DEFAULT '0' COMMENT '是否为默认地址 0 不是默认地址 1 默认地址',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '修改时间',
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `address_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


CREATE TABLE `money` (
  `id` int NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `state` int NOT NULL COMMENT '0 扣款 1 充值 2 退款',
  `money_change` decimal(10,2) NOT NULL COMMENT '变化的钱数',
  `user_id` int NOT NULL COMMENT '用户ID',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '修改时间',
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `money_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
